# Для чего этот скрипт

Этот скрипт предназначен для автоматической отправки писем с вопросами от клиентов Wildberries на указанный почтовый ящик. Скрипт получает список неотвеченных вопросов через API Wildberries, формирует письмо с информацией о каждом вопросе и отправляет его на указанный адрес электронной почты.<br>
Скрипт предназначен для работы в паре с репозиторием (но можно использовать и отдельно) [Wildberries-QuestionsSeller-EmailChecker]() (сначала формируются письма с вопросами, отправляются на почту сотрудника (или проект для обработки вопросов), который их обрабатывает. Затем скрипт `Wildberries-QuestionsSeller-EmailChecker` проверяет почту и отправляет ответы по API. Скрипт создавался, чтобы ослеживать среднее время ответа, количество обработанных вопросов)

___

# Начало работы

* [Структура письма](#структура-письма)  
* [Установка зависимостей](#установка-зависимостей)  
* [Настройка параметров](#настройка-параметров)  
* [Запуск скрипта](#запуск-скрипта)  
* [Как работает скрипт](#как-работает-скрипт)  
* [Обработка ошибок](#обработка-ошибок)  
* [Пример использования](#пример-использования)  
* [Важные замечания](#важные-замечания)  
* [Пример вывода в консоль](#пример-вывода-в-консоль)  


## Структура письма
Каждое письмо содержит следующую информацию:
Текст вопроса:<br>
Ссылка на товар WB:<br>
Название бренда: <br>
ID вопроса: <br>
Дата поступления вопроса: <br>
Артикул на WB:<br>
Название товара: <br>
Артикул продавца: <br>




## Установка зависимостей

Перед запуском скрипта убедитесь, что у вас установлены все необходимые библиотеки. Для этого выполните команду:
```
pip install requests
```


## Настройка параметров

В начале скрипта находятся переменные, которые необходимо настроить перед запуском:<br>
`api_key`: API-ключ для доступа к API Wildberries. Этот ключ необходим для получения списка вопросов.<br>
`fromaddr`: Почта, с которой будет отправляться письмо.<br>
`mypass`: Пароль от почты для внешних приложений.<br>
`toaddr`: Почта, на которую будут отправляться письма.<br>
`questions_sum`: Количество запросов, которые скрипт выполнит для сбора вопросов.<br>


## Запуск скрипта

После настройки параметров запустите скрипт:
```
python mail_send.py
```

## Как работает скрипт

* Получение вопросов: Скрипт отправляет запрос к API Wildberries для получения списка неотвеченных вопросов. Количество вопросов, которые нужно получить, задается параметром `questions_sum`.
* Формирование письма: Для каждого вопроса формируется HTML-письмо, содержащее текст вопроса, ссылку на товар, информацию о бренде, ID вопроса, дату поступления вопроса, артикул товара, название товара и артикул продавца.
* Отправка письма: Скрипт отправляет сформированное письмо на указанный почтовый ящик. Если отправка не удалась, скрипт делает до 2 попыток с интервалом в 2 секунды.
* Логирование: Скрипт выводит информацию о своей работе в консоль, включая статус отправки писем и количество оставшихся писем для отправки.



## Пример использования
Настройте параметры в `mail_send.py`.<br>
Установите зависимости с помощью 
```
pip install requests
```
Запустите скрипт командой 
```
python mail_send.py
```
Скрипт начнет получать вопросы и отправлять письма на указанный почтовый ящик.<br>

## Важные замечания
Убедитесь, что почтовый ящик, указанный в `fromaddr`, поддерживает SMTP-подключение.<br>
Пароль для почтового ящика должен быть паролем для сторонних приложений, если используется почта Mail.ru.<br>
Скрипт отправляет письма только на указанный адрес электронной почты (`toaddr`).

## Пример вывода в консоль
```
Отправляю запрос на сервер для получения вопросов WB
Получил статус-код: 200
Начинаю отправку сообщения(кейса) на email example2@mail.ru.
Сообщение отправлено. Осталось отправить сообщений(кейсов): 9шт.
Начинаю отправку сообщения(кейса) на email example2@mail.ru.
Сообщение отправлено. Осталось отправить сообщений(кейсов): 8шт.
...
...
...
Все сообщения(кейсы) отправлены.
```